<!DOCTYPE html>
<html lang="en">
<head>    
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project 1</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .image-gallery {
            display: flex;
            justify-content: center;
            flex-wrap: nowrap; /* Prevent wrapping to a new row */
            gap: 10px; /* Adds space between the images */
        }
        .image-item {
            text-align: center;
            flex-basis: 30%; /* Adjust width of each image container */
            margin: 0; /* Ensure no additional margin is added */
        }
        img {
            width: 500px;
            height: auto;
        }
        figcaption {
            margin-top: 5px;
            font-style: italic;
        }
    </style>

    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
    <h1>Project 1: Face Morphing</h1>
    <h2>Overview</h2>
    <p>The goal of this project was to accomplish a morph between two images. That was done by establishing a correspondence between
        the two images. The mapping should align key facial features such as eyes to eyes, mouth to mouth, chin to chin and so on, 
        on both images. Using these keypoints a triangulation could be made from which the main goal of the project could be derived, 
        morphing images into each other.
    
    <h2>Defining Correspondences</h2>
    <p>The first task was to define these corresponding keypoints and performing the triangulation. Firstly the images were cropped into 
        the same size and the faces were aligned to some extent. These images are displayed below.
        
    </p>
    
  
    <div class="image-gallery">
        <figure class="image-item">
            <img src="media/carl.png" alt="Original Monastery" width="500">
            <figcaption>A picture of me "Carl"</figcaption>
        </figure>
        <figure class="image-item">
            <img src="media/jacob.png" alt="Monastery" width="500">
            <figcaption>A picture of my younger brother "Jacob"</figcaption>
        </figure>
    </div>

    <p> Then a provided online tool was used to set the correspondences and then the triangulation was made using the 
        <em>scipy.spatial.Delaunay</em> function in python. This resulted in the triangular meshgrid displayed below.
    </p>

    <div class="image-gallery">
        <figure class="image-item">
            <img src="media/carl_tri.png" alt="Original Monastery" width="500">
            <figcaption>Carl: Keypoints and triangulation</figcaption>
        </figure>
        <figure class="image-item">
            <img src="media/jacob_tri.png" alt="Monastery" width="500">
            <figcaption>Jacob: Keypoints and triangulation</figcaption>
        </figure>
    </div>

    <h2>Computing the "Mid-way Face"</h2>


    <p>The next task was to compute the mid-way face of the two images, i.e the midway morph of the two images. This was done by computing 
        the average shape of the triangulation with the following formula: $$Average points = Carl's points * 0.5 + Jacob's points * 0.5$$
        Then the inverse of the affine transformation matrix was computed between the triangles in the images. Using the 
        <em>skimage.draw.polygon</em> function, masks were made for every triangle. These masks were then used to warp all pixels inside the
        triangular mask instead of looping over every pixel. The triangles were warped using an inverse warp. Lastly, a cross-dissolve was used
        to blend the colors of the images. The results are presented down below.
    </p>

    <div class="image-gallery">
        <figure class="image-item">
            <img src="media/carl.png" alt="Original Monastery" width="500">
            <figcaption>Carl</figcaption>
        </figure>
        <figure class="image-item">
            <img src="media/carl_jacob_midway.png" alt="Monastery" width="500">
            <figcaption>Mid-way face</figcaption>
        </figure>
        <figure class="image-item">
            <img src="media/jacob.png" alt="Monastery" width="500">
            <figcaption>Jacob</figcaption>
        </figure>
    </div>


    <h2>The Morph Sequence</h2>

    <p> The next task was to create a sequence of the warps so you can see how one image gradually turns into another. Using different 
        fractions of the warping and cross-dissolving coefficients <em>\in [0,1]</em> this resulted in a morphed sequence with 45 different 
        images and a frame rate of 30 fps. The result is shown below.
        
    </p>
        <div class="image-gallery">
            <figure class="image-item">
                <img src="media/carl_jacob_morph.gif" alt="Monastery" width="500">
                <figcaption>Morphing sequence between me and my brother.</figcaption>
            </figure>
        </div>

    <h3>The "Mean face" of a population</h3>
    
    <p>To see how well the sharpening works an image was first blurred and then sharpened. The results are displayed below.
        As you can see the sharpening doesn't quite do the job since a lot of the high frequencies cannot be retrieved.
    </p>
    <div class="image-gallery">
        <figure class="image-item">
            <img src="media/bild3.png" alt="Original Monastery" width="500">
            <figcaption>Original image</figcaption>
        </figure>
        <figure class="image-item">
            <img src="media/blur1.png" alt="Monastery" width="500">
            <figcaption>Blurred image</figcaption>
        </figure>
        <figure class="image-item">
            <img src="media/sharp1.png" alt="Monastery" width="500">
            <figcaption>Sharpened image</figcaption>
        </figure>
    </div>
    <div class="image-gallery">
        <figure class="image-item">
            <img src="media/bild4.png" alt="Original Monastery" width="500">
            <figcaption>Original image</figcaption>
        </figure>
        <figure class="image-item">
            <img src="media/blur2.png" alt="Monastery" width="500">
            <figcaption>Blurred image</figcaption>
        </figure>
        <figure class="image-item">
            <img src="media/sharp2.png" alt="Monastery" width="500">
            <figcaption>Sharpened image</figcaption>
        </figure>
    </div>

    <h2>Hybrid images</h2>
    <p>By removing the high frequencies from one image and the low frequencies from another and then laying them on top of
        each other we can get something called a hybrid image. When you look at the image up close it looks like the high 
        frequency image but when you look at it from far away it looks like the low frequency image. Below are two examples of 
        hybrid images.<p>

            <div class="image-gallery">
                <figure class="image-item">
                    <img src="media/cat.png" alt="Original Monastery" width="500">
                    <figcaption>Image used for high <em>f</em></figcaption>
                </figure>
                <figure class="image-item">
                    <img src="media/derek.png" alt="Monastery" width="500">
                    <figcaption>Image used for low <em>f</em></figcaption>
                </figure>
                <figure class="image-item">
                    <img src="media/hybrid1.png" alt="Monastery" width="500">
                    <figcaption>Hybrid image</figcaption>
                </figure>
            </div>
            <div class="image-gallery">
                <figure class="image-item">
                    <img src="media/tiger.png" alt="Original Monastery" width="500">
                    <figcaption>Image used for high frequency</figcaption>
                </figure>
                <figure class="image-item">
                    <img src="media/sten.png" alt="Monastery" width="500">
                    <figcaption>Image used for low frequency</figcaption>
                </figure>
                <figure class="image-item">
                    <img src="media/hybrid2.png" alt="Monastery" width="500">
                    <figcaption>Hybrid image</figcaption>
                </figure>
            </div>
            <h3>Fast Fourier transform</h3>
            <p>For the image with the cat the fast fourier transform are presented down below.</p>
            <div class="image-gallery">
                <figure class="image-item">
                    <img src="media/fftcat.png" alt="Original Monastery" width="500">
                    <figcaption>Image used for high frequency</figcaption>
                </figure>
                <figure class="image-item">
                    <img src="media/fftderek.png" alt="Monastery" width="500">
                    <figcaption>Image used for low frequency ("Derek")</figcaption>
                </figure>
                <figure class="image-item">
                    <img src="media/ffthybrid.png" alt="Monastery" width="500">
                    <figcaption>Hybrid image</figcaption>
                </figure>
            </div>
    <p>Also the original images using the fast fourier transform are presented down below.</p>
    <div class="image-gallery">
        <figure class="image-item">
            <img src="media/fftd.png" alt="Monastery" width="500">
            <figcaption>Fast fourier transform on "Derek"</figcaption>
        </figure>
        <figure class="image-item">
            <img src="media/fftc.png" alt="Monastery" width="500">
            <figcaption>Fast Fourier transform on cat</figcaption>
        </figure>
    </div>

    <h2>Gaussian and laplacian stacks</h2>
    <p>In this part laplacian stacks were made using gaussian stacks. Down below, the result from using a laplacian stack
        and displaying every level (five were used) on an apple and an orange.
        <div class="image-gallery">
            <figure class="image-item">
                <img src="media/lap1.png" alt="Monastery" width="500">
                <figcaption>Apple - Level 1</figcaption>
            </figure>
            <figure class="image-item">
                <img src="media/lor1.png" alt="Monastery" width="500">
                <figcaption>Orange - Level 1</figcaption>
            </figure>
        </div>
        <div class="image-gallery">
            <figure class="image-item">
                <img src="media/lap2.png" alt="Monastery" width="500">
                <figcaption>Apple - Level 2</figcaption>
            </figure>
            <figure class="image-item">
                <img src="media/lor2.png" alt="Monastery" width="500">
                <figcaption>Orange - Level 2</figcaption>
            </figure>
        </div>
        <div class="image-gallery">
            <figure class="image-item">
                <img src="media/lap3.png" alt="Monastery" width="500">
                <figcaption>Apple - Level 3</figcaption>
            </figure>
            <figure class="image-item">
                <img src="media/lor3.png" alt="Monastery" width="500">
                <figcaption>Orange - Level 3</figcaption>
            </figure>
        </div>
        <div class="image-gallery">
            <figure class="image-item">
                <img src="media/lap4.png" alt="Monastery" width="500">
                <figcaption>Apple - Level 4</figcaption>
            </figure>
            <figure class="image-item">
                <img src="media/lor4.png" alt="Monastery" width="500">
                <figcaption>Orange - Level 4</figcaption>
            </figure>
        </div>
        <div class="image-gallery">
            <figure class="image-item">
                <img src="media/lap5.png" alt="Monastery" width="500">
                <figcaption>Apple - Level 5</figcaption>
            </figure>
            <figure class="image-item">
                <img src="media/lor5.png" alt="Monastery" width="500">
                <figcaption>Orange - Level 3</figcaption>
            </figure>
        </div>

    <h2>Multiresolution blending</h2>

    <p>For the last part, the purpose was to blend different images using a mask. The first images which were an apple and an 
        orange are presented down below. The result isn't quite as good as the one shown in the paper by Burt and Adelson but still
        alright in my opinion.</p>

        <div class="image-gallery">
            <figure class="image-item">
                <img src="media/apple.png" alt="Original Monastery" width="500">
                <figcaption>Apple</figcaption>
            </figure>
            <figure class="image-item">
                <img src="media/orange.png" alt="Monastery" width="500">
                <figcaption>Orange</figcaption>
            </figure>
            <figure class="image-item">
                <img src="media/orangeapple.png" alt="Monastery" width="500">
                <figcaption>Oraple image</figcaption>
            </figure>
        </div>

        <p>Down below is a failed attempt at blending a green apple and a tennis ball.</p>


        <div class="image-gallery">
            <figure class="image-item">
                <img src="media/apple2.png" alt="Original Monastery" width="500">
                <figcaption>Green apple</figcaption>
            </figure>
            <figure class="image-item">
                <img src="media/tennis.png" alt="Monastery" width="500">
                <figcaption>Tennis ball</figcaption>
            </figure>
            <figure class="image-item">
                <img src="media/Tapple.png" alt="Monastery" width="500">
                <figcaption>Tapple</figcaption>
            </figure>
        </div>
        <p>Lastly I used an irregular mask to change the football into a an orange which  is displayed below.</p>
        <div class="image-gallery">
            <figure class="image-item">
                <img src="media/zlatan.png" alt="Original Monastery" width="500">
                <figcaption>Zlatan Ibrahimovic</figcaption>
            </figure>
            <figure class="image-item">
                <img src="media/orange2.png" alt="Monastery" width="500">
                <figcaption>Orange</figcaption>
            </figure>
            <figure class="image-item">
                <img src="media/ballmask.png" alt="Monastery" width="500">
                <figcaption>Irregular mask</figcaption>
            </figure>
        </div>
        <div class="image-gallery">
            <figure class="image-item">
                <img src="media/ozlatan.png" alt="Monastery" width="500">
                <figcaption>Zlatan with an orange</figcaption>
            </figure>
        </div>
        <h2>Bells & whistles</h2>
        <p>All implementations were made with colors.</p>

    </p>
    <p><a href="../index.html">Back to Main Page</a></p>
</body>
</html>
